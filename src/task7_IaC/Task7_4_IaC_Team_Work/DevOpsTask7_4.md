### Домашнее задание 7-4

# Задание 1
    Настроить terraform cloud (необязательно, но крайне желательно).
    
    В это задании предлагается познакомиться со средством командой работы над инфраструктурой предоставляемым разработчиками терраформа.
    
        Зарегистрируйтесь на https://app.terraform.io/. (регистрация бесплатная и не требует использования платежных инструментов).
        Создайте в своем github аккаунте (или другом хранилище репозиториев) отдельный репозиторий с конфигурационными файлами прошлых занятий (или воспользуйтесь любым простым конфигом).
        Зарегистрируйте этот репозиторий в https://app.terraform.io/.
        Выполните plan и apply.
    
    В качестве результата задания приложите снимок экрана с успешным применением конфигурации.
# Решение 1
    Разрешили пропустить по причине неактуальности и недоступности terraform cloud.

# Задание 2
    Написать серверный конфиг для атлантиса.
    
    Смысл задания – познакомиться с документацией о серверной конфигурации и конфигурации уровня репозитория.
    
    Создай server.yaml который скажет атлантису:
    
        Укажите, что атлантис должен работать только для репозиториев в вашем github (или любом другом) аккаунте.
        На стороне клиентского конфига разрешите изменять workflow, то есть для каждого репозитория можно будет указать свои дополнительные команды.
        В workflow используемом по-умолчанию сделайте так, что бы во время планирования не происходил lock состояния.
    
    Создай atlantis.yaml который, если поместить в корень terraform проекта, скажет атлантису:
    
        Надо запускать планирование и аплай для двух воркспейсов stage и prod.
        Необходимо включить автопланирование при изменении любых файлов *.tf.
    
    В качестве результата приложите ссылку на файлы server.yaml и atlantis.yaml.

# Решение 2
    Все настройки сервера приведены в файле:
[server.yaml](server.yaml)

    Укажите, что атлантис должен работать только для репозиториев в вашем github (или любом другом) аккаунте.
```yaml
  - id: github.com/EfanRu/DevOpsTask
```

    На стороне клиентского конфига разрешите изменять workflow, то есть для каждого репозитория можно будет указать свои дополнительные команды.
```yaml
  allowed_overrides: [workflow]
```
    В workflow используемом по-умолчанию сделайте так, что бы во время планирования не происходил lock состояния.
```yaml
  repo_locking: false
```

    Настройки локальные приведены в файле:
[atlantis.yaml](atlantis.yaml)

    Надо запускать планирование и аплай для двух воркспейсов stage и prod.
```yaml
  workspace: [prod, stage]
```

    Необходимо включить автопланирование при изменении любых файлов *.tf.
```yaml
  autoplan:
    when_modified: [ "*.tf", "../modules/**/*.tf" ]
```

# Задание 3
    Знакомство с каталогом модулей.
    
        В каталоге модулей найдите официальный модуль от aws для создания ec2 инстансов.
        Изучите как устроен модуль. Задумайтесь, будете ли в своем проекте использовать этот модуль или непосредственно ресурс aws_instance без помощи модуля?
        В рамках предпоследнего задания был создан ec2 при помощи ресурса aws_instance. Создайте аналогичный инстанс при помощи найденного модуля.
    
    В качестве результата задания приложите ссылку на созданный блок конфигураций.

# Решение 3
    Так как модуль для aws не актуален, то будем работать с модулем для Yandex Cloud.
```terraform
module "compute" {
  source  = "glavk/compute/yandex"
  version = "0.1.2"

  image_family = "ubuntu-docker"
  subnet       = "sn-dev-0"
  folder_id    = "xxx"

  name     = "development"
  hostname = "dev"
  is_nat   = true

  cores  = 2
  memory = 4
  size   = "10"

  preemptible = true

  sg_id = ["xxx"]

}
```

    Изучите как устроен модуль. Задумайтесь, будете ли в своем проекте использовать этот модуль или непосредственно ресурс aws_instance без помощи модуля?
        С точки зрения переиспользования кода думаю стоит использовать модули.

    В рамках предпоследнего задания был создан ec2 при помощи ресурса aws_instance. Создайте аналогичный инстанс при помощи найденного модуля.
        Применение модуля можно посмотреть в файле:
[module.tf](module.tf)